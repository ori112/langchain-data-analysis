# LangChain + Gemini DataFrame Agent

A lightweight Python agent that connects a Gemini-powered LLM to Google Sheets for smart, interactive data analysis — including plotting, summarization, and free-text querying.

## Features

- Connects to **Google Sheets** via service account (can connect to various data sources)
- Uses **Gemini 2.5** via `langchain_google_genai`
- Executes LLM-generated **Python code** on merged DataFrames
- Supports natural language questions

## Stack

- `LangChain` (agent + experimental dataframe toolkit)
- `Google Generative AI` (Gemini 2.5 model)
- Managed using [`uv`](https://github.com/astral-sh/uv) and `pyproject.toml`

## Project Structure

```
langchain-data-analysis/
├── .env                  # your local environment variables (not tracked)
├── secrets/              # contains service_account.json (ignored)
├── main.py               # main entry point
├── pyproject.toml        # dependency config
├── uv.lock               # lockfile generated by uv
```

## Getting Started

```bash
# Clone the repo
git clone https://github.com/ori112/langchain-data-analysis
cd langchain-data-analysis

# Create virtual environment
python -m venv .venv
source .venv/bin/activate  # or .venv\Scripts\activate on Windows

# Install dependencies with uv
uv venv install
```

## Setup

1. Place your **Google service account key** JSON in `secrets/google_sheets_keys.json`
2. Create a `.env` file and add:
   ```env
   GOOGLE_APPLICATION_CREDENTIALS=secrets/google_sheets_keys.json
   ```

## Prompt Examples

```
"Show ROAS per campaign"
"Visualize revenue over time"
"Which campaign had the highest conversion rate?"
```

## License

MIT – free to use, modify, and share.
